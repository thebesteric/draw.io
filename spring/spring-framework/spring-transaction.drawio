<mxfile host="app.diagrams.net" modified="2022-04-05T15:02:46.774Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.83 Safari/537.36" etag="HKHDgmfepDoRDKgf8fhl" version="17.2.4" type="github">
  <diagram id="kz3dH1U2wMBaOtRKHvNg" name="Page-1">
    <mxGraphModel dx="6757" dy="3700" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-303" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=2;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-301" target="4VrhSYovmqzg8rR9ZFnU-112">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1070" y="2500" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="h3sMWkzl3CLincA4zuW1-1" target="h3sMWkzl3CLincA4zuW1-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-1" value="@EnableTransactionManagement" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;" parent="1" vertex="1">
          <mxGeometry x="280" y="40" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-5" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="h3sMWkzl3CLincA4zuW1-2" target="h3sMWkzl3CLincA4zuW1-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-2" value="@Import(TransactionManagementConfigurationSelector.class)" style="whiteSpace=wrap;html=1;fillColor=#60a917;strokeColor=#2D7600;fontColor=#ffffff;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="210" y="150" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-7" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;" parent="1" source="h3sMWkzl3CLincA4zuW1-4" target="h3sMWkzl3CLincA4zuW1-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-4" value="TransactionManagementConfigurationSelector#&lt;font color=&quot;#ff0000&quot;&gt;selectImports&lt;/font&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="215" y="270" width="350" height="60" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-13" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;" parent="1" source="h3sMWkzl3CLincA4zuW1-6" target="h3sMWkzl3CLincA4zuW1-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-49" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="h3sMWkzl3CLincA4zuW1-6" target="4VrhSYovmqzg8rR9ZFnU-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-6" value="&lt;div&gt;return new String[] {&lt;font color=&quot;#ff0000&quot;&gt;AutoProxyRegistrar.class&lt;/font&gt;.getName(),&lt;/div&gt;&lt;div&gt;&lt;span&gt;      &lt;/span&gt;&lt;font color=&quot;#ff0000&quot;&gt;ProxyTransactionManagementConfiguration.class&lt;/font&gt;.getName()};&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="205" y="480" width="370" height="60" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-8" value="1、AutoProxyRegistrar 注册了&amp;nbsp;InfrastructureAdvisorAutoProxyCreator&lt;br&gt;作用：查找 Advisor&lt;br&gt;2、ProxyTransactionManagementConfiguration 注册了 3 个 bean&lt;br&gt;BeanFactoryTransactionAttributeSourceAdvisor 是一个 advisor&lt;br&gt;AnnotationTransactionAttributeSource 封装了 @Transactional 注解信息&lt;br&gt;TransactionInterceptor 是一个 Advice" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=left;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="-150" y="360" width="410" height="90" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-9" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" parent="1" source="h3sMWkzl3CLincA4zuW1-6" target="h3sMWkzl3CLincA4zuW1-8" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="60" y="400" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-15" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;" parent="1" source="h3sMWkzl3CLincA4zuW1-12" target="h3sMWkzl3CLincA4zuW1-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-25" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;dashed=1;strokeWidth=2;" parent="1" source="h3sMWkzl3CLincA4zuW1-12" target="h3sMWkzl3CLincA4zuW1-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-12" value="&lt;div&gt;@Bean(name = TransactionManagementConfigUtils.TRANSACTION_ADVISOR_BEAN_NAME)&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;@Role(BeanDefinition.ROLE_INFRASTRUCTURE)&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;public &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;BeanFactoryTransactionAttributeSourceAdvisor&lt;/font&gt;&lt;/b&gt; transactionAdvisor(&lt;/div&gt;&lt;div&gt;&lt;span&gt;   &lt;/span&gt;TransactionAttributeSource &lt;b&gt;transactionAttributeSource&lt;/b&gt;, // AnnotationTransactionAttributeSource&lt;/div&gt;&lt;div&gt;&lt;span&gt;   &lt;/span&gt;TransactionInterceptor &lt;b&gt;transactionInterceptor&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;// 创建一个 Advisor&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;BeanFactoryTransactionAttributeSourceAdvisor&lt;/font&gt;&lt;/b&gt; advisor = new BeanFactoryTransactionAttributeSourceAdvisor();&lt;/div&gt;&lt;div&gt;// 设置切点的属性解析器&lt;/div&gt;&lt;div&gt;&lt;b&gt;advisor.setTransactionAttributeSource(transactionAttributeSource);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;// ★★★ 设置代理逻辑，是一个 TransactionInterceptor 对象，会执行其 invoke 方法&lt;/div&gt;&lt;div&gt;// 来处理事务，开启事务，关闭事务，回滚，提交等&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;advisor.setAdvice(transactionInterceptor);&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;if (this.enableTx != null) {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;advisor.setOrder(this.enableTx.&amp;lt;Integer&amp;gt;getNumber(&quot;order&quot;));&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;return advisor;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;align=left;spacing=6;" parent="1" vertex="1">
          <mxGeometry x="48.13" y="620" width="683.75" height="320" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-17" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;" parent="1" source="h3sMWkzl3CLincA4zuW1-14" target="h3sMWkzl3CLincA4zuW1-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-30" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontColor=#FF0000;strokeWidth=1;dashed=1;" parent="1" source="h3sMWkzl3CLincA4zuW1-14" target="h3sMWkzl3CLincA4zuW1-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-14" value="&lt;div&gt;// 提供 @Transactional 注解的信息&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;@Bean&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;@Role(BeanDefinition.ROLE_INFRASTRUCTURE)&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;public &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;TransactionAttributeSource&lt;/font&gt;&lt;/b&gt; transactionAttributeSource() {&lt;/div&gt;&lt;div&gt;&lt;span&gt;  &lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;// 用于解析 @Transactional 注解的信息&lt;/div&gt;&lt;div&gt;&lt;span&gt;  &lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;return new &lt;font color=&quot;#ff0000&quot;&gt;&lt;b&gt;AnnotationTransactionAttributeSource&lt;/b&gt;&lt;/font&gt;();&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" parent="1" vertex="1">
          <mxGeometry x="205" y="1010" width="370" height="130" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-47" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1" source="h3sMWkzl3CLincA4zuW1-16" target="4VrhSYovmqzg8rR9ZFnU-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-16" value="&lt;div&gt;// advice&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;@Bean&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;@Role(BeanDefinition.ROLE_INFRASTRUCTURE)&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;public &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;TransactionInterceptor&lt;/font&gt;&lt;/b&gt; transactionInterceptor(TransactionAttributeSource transactionAttributeSource) {&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;TransactionInterceptor interceptor = new TransactionInterceptor();&lt;/div&gt;&lt;div&gt;// 拦截器中持有 @Transactional 注解的信息&lt;/div&gt;&lt;div&gt;interceptor.setTransactionAttributeSource(transactionAttributeSource);&lt;/div&gt;&lt;div&gt;if (this.txManager != null) {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#3399ff&quot;&gt;interceptor.setTransactionManager(&lt;/font&gt;&lt;font color=&quot;#ff0000&quot;&gt;this.txManager&lt;/font&gt;&lt;font color=&quot;#3399ff&quot;&gt;);&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;return interceptor;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" parent="1" vertex="1">
          <mxGeometry x="85" y="1230" width="610" height="215" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-18" value="Advisor" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="50" y="560" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-19" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" parent="1" source="h3sMWkzl3CLincA4zuW1-12" target="h3sMWkzl3CLincA4zuW1-18" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-70" y="585" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-20" value="Advice" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="60" y="1160" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-21" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" parent="1" source="h3sMWkzl3CLincA4zuW1-16" target="h3sMWkzl3CLincA4zuW1-20" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="10" y="1180" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-22" value="解析 @Transactional 注解信息" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="30" y="970" width="200" height="20" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-23" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" parent="1" source="h3sMWkzl3CLincA4zuW1-14" target="h3sMWkzl3CLincA4zuW1-22" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="50" y="1010" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-27" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" parent="1" source="h3sMWkzl3CLincA4zuW1-24" target="h3sMWkzl3CLincA4zuW1-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-24" value="&lt;span&gt;BeanFactoryTransactionAttributeSourceAdvisor&lt;/span&gt;" style="whiteSpace=wrap;html=1;align=center;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=5;" parent="1" vertex="1">
          <mxGeometry x="960" y="750" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;strokeWidth=2;dashed=1;" edge="1" parent="1" source="h3sMWkzl3CLincA4zuW1-26" target="4VrhSYovmqzg8rR9ZFnU-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-6" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="h3sMWkzl3CLincA4zuW1-26" target="4VrhSYovmqzg8rR9ZFnU-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-26" value="&lt;div&gt;private final &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;TransactionAttributeSourcePointcut&lt;/font&gt;&lt;/b&gt; pointcut = new TransactionAttributeSourcePointcut() {&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;@Override&lt;/div&gt;&lt;div&gt;@Nullable&lt;/div&gt;&lt;div&gt;protected TransactionAttributeSource getTransactionAttributeSource() {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;// AnnotationTransactionAttributeSource&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;transactionAttributeSource&lt;/font&gt;&lt;/b&gt;;&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;};&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;align=left;" parent="1" vertex="1">
          <mxGeometry x="815" y="890" width="570" height="140" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-28" value="PointCut" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="827" y="830" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="h3sMWkzl3CLincA4zuW1-29" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" parent="1" source="h3sMWkzl3CLincA4zuW1-26" target="h3sMWkzl3CLincA4zuW1-28" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="904.5" y="880" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-4" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#3399FF;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-1" target="4VrhSYovmqzg8rR9ZFnU-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-1" value="&lt;div&gt;protected TransactionAttributeSourcePointcut() {&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;// 类过滤：检查类上是否有 @Transactional 注解&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#3399ff&quot;&gt;setClassFilter(&lt;/font&gt;&lt;font color=&quot;#ff0000&quot;&gt;new TransactionAttributeSourceClassFilter()&lt;/font&gt;&lt;font color=&quot;#3399ff&quot;&gt;);&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#3399ff&quot;&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1502.5" y="915" width="430" height="90" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-10" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-3" target="4VrhSYovmqzg8rR9ZFnU-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-11" value="&lt;font color=&quot;#ff0000&quot;&gt;SpringTransactionAnnotationParser#isCandidateClass&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#000000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-10">
          <mxGeometry x="0.0909" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-3" value="&lt;div&gt;private class &lt;b&gt;TransactionAttributeSourceClassFilter&lt;/b&gt; implements ClassFilter {&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;@Override&lt;/div&gt;&lt;div&gt;public boolean &lt;b&gt;&lt;font color=&quot;#3399ff&quot;&gt;matches(Class&amp;lt;?&amp;gt; clazz)&lt;/font&gt;&lt;/b&gt; {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;if (TransactionalProxy.class.isAssignableFrom(clazz) ||&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionManager.class.isAssignableFrom(clazz) ||&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;PersistenceExceptionTranslator.class.isAssignableFrom(clazz)) {&lt;/span&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return false;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;// 获取到 AnnotationTransactionAttributeSource 对象&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;TransactionAttributeSource tas = getTransactionAttributeSource();&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;// 判断类上是否有 @Transactional 注解&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;return (tas == null || &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;tas.isCandidateClass(clazz)&lt;/font&gt;&lt;/b&gt;);&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="1460" y="1070" width="515" height="230" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-8" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#000000;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-5" target="4VrhSYovmqzg8rR9ZFnU-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-12" value="&lt;font color=&quot;#ff0000&quot;&gt;AbstractFallbackTransactionAttributeSource#getTransactionAttribute&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FFFF66;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-8">
          <mxGeometry x="0.0857" y="1" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-5" value="&lt;div&gt;@Override&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;public boolean &lt;b&gt;&lt;font color=&quot;#3399ff&quot;&gt;matches(Method method, Class&amp;lt;?&amp;gt; targetClass) &lt;/font&gt;&lt;/b&gt;{&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;TransactionAttributeSource tas = getTransactionAttributeSource();&lt;/div&gt;&lt;div&gt;// 调用 AnnotationTransactionAttributeSource 父类 AbstractFallbackTransactionAttributeSource 的 getTransactionAttribute 方法&lt;/div&gt;&lt;div&gt;// ★★★ 判断是否有 @Transactional 注解&lt;/div&gt;&lt;div&gt;return (tas == null || &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;tas.getTransactionAttribute(method, targetClass) != null)&lt;/font&gt;&lt;/b&gt;;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="850" y="1112.5" width="500" height="145" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-14" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fontColor=#FF0000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-7" target="4VrhSYovmqzg8rR9ZFnU-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-33" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontColor=#FF0000;strokeWidth=1;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-7" target="4VrhSYovmqzg8rR9ZFnU-5">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1420" y="1400" />
              <mxPoint x="1420" y="1185" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-7" value="TransactionAttribute txAttr = computeTransactionAttribute(method, targetClass);" style="whiteSpace=wrap;html=1;align=center;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="875" y="1370" width="450" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-36" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-9" target="4VrhSYovmqzg8rR9ZFnU-3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2100" y="1430" />
              <mxPoint x="2100" y="1185" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-9" value="&lt;div&gt;@Override&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;public boolean isCandidateClass(Class&amp;lt;?&amp;gt; targetClass) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;AnnotationUtils.isCandidateClass(targetClass, Transactional.class);&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="1480.63" y="1380" width="473.75" height="100" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-18" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-13" target="4VrhSYovmqzg8rR9ZFnU-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-13" value="TransactionAttribute txAttr = findTransactionAttribute(specificMethod);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="965" y="1510" width="270" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-20" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-17" target="4VrhSYovmqzg8rR9ZFnU-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-22" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-17" target="4VrhSYovmqzg8rR9ZFnU-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-23" value="if (txAttr != null)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-22">
          <mxGeometry x="0.0677" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-17" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1620" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-26" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-19" target="4VrhSYovmqzg8rR9ZFnU-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-19" value="txAttr = findTransactionAttribute(specificMethod.getDeclaringClass());" style="whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="922.5" y="1760" width="355" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-35" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontColor=#FF0000;strokeWidth=1;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-21" target="4VrhSYovmqzg8rR9ZFnU-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="730" y="1660" />
              <mxPoint x="730" y="1400" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-21" value="return txAttr;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="780" y="1630" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-27" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-25" target="4VrhSYovmqzg8rR9ZFnU-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-28" value="if (txAttr != null &amp;amp;&amp;amp; ClassUtils.isUserLevelMethod(method))" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-27">
          <mxGeometry x="0.1956" y="-56" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-30" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-25" target="4VrhSYovmqzg8rR9ZFnU-29">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-25" value="&lt;span&gt;判断&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1060" y="1880" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-29" value="retrun null;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="1040" y="2010" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-38" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-37" target="h3sMWkzl3CLincA4zuW1-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-37" value="&lt;div&gt;// 事务管理器&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;@Bean&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;public &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;PlatformTransactionManager&lt;/font&gt;&lt;/b&gt; transactionManager(DataSource &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;dataSource&lt;/font&gt;&lt;/b&gt;) {&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;DataSourceTransactionManager transactionManager = new DataSourceTransactionManager();&lt;/div&gt;transactionManager&lt;span&gt;.setDataSource(dataSource);&lt;/span&gt;&lt;div&gt;// 设置要不要把事务信息同步到线程中&lt;/div&gt;&lt;div&gt;// transactionManager.setTransactionSynchronization(1);&lt;/div&gt;&lt;div&gt;// 部分失败是否全局回滚，如果设置 false 的话，则不会如果有 tryCatch 则还是会全部提交，否则全部回滚&lt;/div&gt;transactionManager&lt;span&gt;.setGlobalRollbackOnParticipationFailure(true);&lt;/span&gt;&lt;div&gt;return transactionManager;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;}&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontColor=#333333;align=left;spacing=6;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="-670" y="1243" width="660" height="189" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-40" value="事物管理器" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="-620" y="1175" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-41" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-40" parent="1" source="4VrhSYovmqzg8rR9ZFnU-37">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-520" y="1180" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-43" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-42" target="4VrhSYovmqzg8rR9ZFnU-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-42" value="&lt;div&gt;@Bean&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;public &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;DataSource&lt;/font&gt;&lt;/b&gt; dataSource() {&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// DriverManagerDataSource dataSource = new DriverManagerDataSource();&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;DruidDataSource dataSource = new DruidDataSource();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;dataSource.setUsername(&quot;root&quot;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;dataSource.setPassword(&quot;root&quot;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;dataSource.setUrl(&quot;jdbc:mysql://127.0.0.1:3306/test“);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;dataSource.setDriverClassName(&quot;com.mysql.cj.jdbc.Driver&quot;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return dataSource;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;}&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fontColor=#333333;fillColor=#f5f5f5;strokeColor=#666666;align=left;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="-650" y="950" width="620" height="190" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-44" value="数据源" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="-610" y="880" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-45" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-44" source="4VrhSYovmqzg8rR9ZFnU-42">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-504.9999999999998" y="938" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-55" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-46" target="4VrhSYovmqzg8rR9ZFnU-54">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-46" value="&lt;div&gt;@Override&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;@Nullable&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;public Object &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;invoke&lt;/font&gt;&lt;/b&gt;(MethodInvocation invocation) throws Throwable {&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;// Work out the target class: may be {@code null}.&lt;/div&gt;&lt;div&gt;// The TransactionAttributeSource should be passed the target class&lt;/div&gt;&lt;div&gt;// as well as the method, which may be from an interface.&lt;/div&gt;&lt;div&gt;Class&amp;lt;?&amp;gt; targetClass = (invocation.getThis() != null ? AopUtils.getTargetClass(invocation.getThis()) : null);&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;// Adapt to TransactionAspectSupport&#39;s invokeWithinTransaction...&lt;/div&gt;&lt;div&gt;// ★★★ 执行代理逻辑&lt;/div&gt;&lt;div&gt;return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;invokeWithinTransaction&lt;/font&gt;&lt;/b&gt;(invocation.getMethod(), targetClass, new CoroutinesInvocationCallback() {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;@Override&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;@Nullable&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;public Object &lt;b&gt;proceedWithInvocation()&lt;/b&gt; throws Throwable {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;invocation.proceed();&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;@Override&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;public Object getTarget() {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return invocation.getThis();&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;@Override&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;public Object[] getArguments() {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return invocation.getArguments();&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;});&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="72.5" y="1596.25" width="635" height="387.5" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-51" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-48" target="4VrhSYovmqzg8rR9ZFnU-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-48" value="InfrastructureAdvisorAutoProxyCreator extends AbstractAdvisorAutoProxyCreator" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="720" y="480" width="290" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-50" value="&lt;div&gt;// 正常情况下进行 AOP 的入口&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;@Override&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;public Object &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;postProcessAfterInitialization&lt;/font&gt;&lt;/b&gt;(@Nullable Object bean, String beanName) {&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;if (bean != null) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 获取缓存 key&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;Object cacheKey = getCacheKey(bean.getClass(), beanName);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// earlyProxyReferences：早期的代理对象引用：提前进行 AOP 的对象（循环依赖）会存在在这个集合中&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;if (this.earlyProxyReferences.remove(cacheKey) != bean) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// ★★★ 没有提前进行 AOP，则在这里进行 AOP&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return wrapIfNecessary(bean, beanName, cacheKey);&lt;/span&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;return bean;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;fontColor=#333333;align=left;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1110" y="390" width="660" height="240" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-52" value="BeanPostProcessor" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="850" y="420" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-53" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-52" parent="1" source="4VrhSYovmqzg8rR9ZFnU-48">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="750" y="430" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-59" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-54" target="4VrhSYovmqzg8rR9ZFnU-58">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-54" value="TransactionAspectSupport#invokeWithinTransaction" style="whiteSpace=wrap;html=1;align=center;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="225" y="2090" width="329.99" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-56" value="代理逻辑" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="40" y="1510" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-57" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-56" parent="1" source="4VrhSYovmqzg8rR9ZFnU-46">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="1550" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-62" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-58" target="h3sMWkzl3CLincA4zuW1-14">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="130" y="1110" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-40" y="2250" />
              <mxPoint x="-40" y="1075" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-64" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-58" target="4VrhSYovmqzg8rR9ZFnU-63">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-58" value="TransactionAttributeSource tas = getTransactionAttributeSource();" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="205" y="2220" width="370.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-60" value="获取解析 @Transactional 注解的工具" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="38.13" y="2180" width="230" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-61" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-60" parent="1" source="4VrhSYovmqzg8rR9ZFnU-58">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="73" y="2200" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-68" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-63" target="4VrhSYovmqzg8rR9ZFnU-67">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-63" value="final TransactionAttribute txAttr = (tas != null ? tas.getTransactionAttribute(method, targetClass) : null);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="214.99" y="2360" width="350" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-65" value="解析方法或类上 @Transactional 注解信息&lt;br&gt;先解析方法，如果方法没有则解析类" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry y="2300" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-66" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-65" parent="1" source="4VrhSYovmqzg8rR9ZFnU-63">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="302.4899999999998" y="2380" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-69" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-67" target="4VrhSYovmqzg8rR9ZFnU-37">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-210" y="1780" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-74" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-67" target="4VrhSYovmqzg8rR9ZFnU-73">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-67" value="final TransactionManager tm = determineTransactionManager(txAttr);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="190" y="2500" width="400.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-71" value="PlatformTransactionManager" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="70" y="2450" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-72" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-71" parent="1" source="4VrhSYovmqzg8rR9ZFnU-67">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="60" y="2470" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-78" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-73" target="4VrhSYovmqzg8rR9ZFnU-77">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-73" value="final String &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;joinpointIdentification&lt;/font&gt;&lt;/b&gt; = methodIdentification(method, targetClass, txAttr);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="235" y="2630" width="310" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-75" value="根据当前执行的类中的某个方法生成一个唯一标志，这个标记会用做事务名&lt;br&gt;类名 + 方法 的名字" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="-160" y="2580" width="430" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-76" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-75" parent="1" source="4VrhSYovmqzg8rR9ZFnU-73">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-320" y="2520" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-87" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-77" target="4VrhSYovmqzg8rR9ZFnU-165">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="389.99000000000024" y="2880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-107" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-77" target="4VrhSYovmqzg8rR9ZFnU-106">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="640" y="2800" />
              <mxPoint x="640" y="2220" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-77" value="TransactionInfo txInfo = createTransactionIfNecessary(ptm, txAttr, joinpointIdentification);" style="whiteSpace=wrap;html=1;fillColor=#6a00ff;strokeColor=#3700CC;rounded=0;spacing=6;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="214.99" y="2770" width="350" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-79" value="创建事务，并得到事务信息，后面需要事务信息来进行提交或回滚&lt;br&gt;如果有必要就创建事物，这里就涉及到事物到传播机制到实现&lt;br&gt;TransactionInfo 表示一个逻辑事务，比如两个逻辑事务属于同一个物理事务" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="-150" y="2700" width="430" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-80" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-79" parent="1" source="4VrhSYovmqzg8rR9ZFnU-77">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="93" y="2740" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-90" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-81" target="4VrhSYovmqzg8rR9ZFnU-166">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="389.99499999999944" y="3100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-102" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-81" target="4VrhSYovmqzg8rR9ZFnU-46">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-160" y="1477.6470588235295" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-230" y="3020" />
              <mxPoint x="-230" y="1790" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-81" value="retVal = invocation.proceedWithInvocation();" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="279.99" y="2990" width="220.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-83" value="执行具体的业务方法" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="159.99" y="2950" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-84" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-83" parent="1" source="4VrhSYovmqzg8rR9ZFnU-81">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="94.99" y="2980" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-88" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-165" target="4VrhSYovmqzg8rR9ZFnU-81">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="389.9899999999993" y="2940" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-92" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-166" target="4VrhSYovmqzg8rR9ZFnU-91">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="389.9949999999999" y="3160" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-94" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-91" target="4VrhSYovmqzg8rR9ZFnU-167">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="389.9850000000001" y="3320" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-91" value="completeTransactionAfterThrowing(txInfo, ex);&lt;br&gt;&lt;font color=&quot;#ff0000&quot;&gt;throw ex;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="255.00000000000003" y="3210" width="270.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-96" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-167" target="4VrhSYovmqzg8rR9ZFnU-95">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="389.9850000000001" y="3380" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-104" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-95" target="4VrhSYovmqzg8rR9ZFnU-103">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-95" value="cleanupTransactionInfo(txInfo);" style="whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="280" y="3430" width="220.02" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-97" value="回滚" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="200" y="3150" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-98" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-97" parent="1" source="4VrhSYovmqzg8rR9ZFnU-91">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="150" y="3190" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-99" value="清除 ThreadLocal 中的事务信息，释放连接" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="48.13" y="3380" width="260" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-100" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-99" parent="1" source="4VrhSYovmqzg8rR9ZFnU-95">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="60" y="3380" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-105" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-103" target="4VrhSYovmqzg8rR9ZFnU-46">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-180" y="2640" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-230" y="3600" />
              <mxPoint x="-230" y="1887" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-103" value="return. retVal;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="330.01" y="3570" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-109" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-106" target="4VrhSYovmqzg8rR9ZFnU-73">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-113" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-106" target="4VrhSYovmqzg8rR9ZFnU-112">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-106" value="&lt;div&gt;if (txAttr != null &amp;amp;&amp;amp; txAttr.getName() == null) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;txAttr = new DelegatingTransactionAttribute(txAttr) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;@Override&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;public String getName() {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;return joinpointIdentification;&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;};&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;align=left;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="815" y="2147.5" width="338.12" height="145" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-110" value="设置事务的名称" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="740" y="2100" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-111" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-110" parent="1" source="4VrhSYovmqzg8rR9ZFnU-106">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="787" y="2120" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-115" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-112" target="4VrhSYovmqzg8rR9ZFnU-114">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-120" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-112" target="4VrhSYovmqzg8rR9ZFnU-119">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-112" value="TransactionStatus status = tm.getTransaction(txAttr);" style="whiteSpace=wrap;html=1;align=center;fillColor=#d80073;strokeColor=#A50040;rounded=0;spacing=6;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="827" y="2415" width="315.94" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-116" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-114" target="4VrhSYovmqzg8rR9ZFnU-77">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-246" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-114" target="4VrhSYovmqzg8rR9ZFnU-245">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-114" value="return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;prepareTransactionInfo&lt;/font&gt;&lt;/b&gt;(tm, txAttr, joinpointIdentification, status);" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="776.54" y="2630" width="415.03" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-117" value="通过 TransactionManager 和 @Transactional 注解的信息&lt;br&gt;开启一个事务，传播机制就在这里体现" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1100" y="2350" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-118" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-117" parent="1" source="4VrhSYovmqzg8rR9ZFnU-112">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="730" y="2375" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-122" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-119" target="4VrhSYovmqzg8rR9ZFnU-121">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-119" value="Object transaction = doGetTransaction();" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1582.96" y="1670" width="269.09" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-124" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-121" target="4VrhSYovmqzg8rR9ZFnU-123">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-125" value="&lt;b&gt;if (isExistingTransaction(transaction))&lt;/b&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-124">
          <mxGeometry x="-0.022" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-129" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-121" target="4VrhSYovmqzg8rR9ZFnU-128">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-131" value="没有连接，首次" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-129">
          <mxGeometry x="-0.1868" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-121" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1677.505" y="1800" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-305" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=2;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-123" target="4VrhSYovmqzg8rR9ZFnU-304">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-123" value="return &lt;font color=&quot;#ff0000&quot;&gt;handleExistingTransaction&lt;/font&gt;(def, transaction, debugEnabled);" style="whiteSpace=wrap;html=1;fillColor=#6a00ff;strokeColor=#3700CC;rounded=0;spacing=6;fontStyle=1;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="2040" y="1810" width="270" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-133" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-128" target="4VrhSYovmqzg8rR9ZFnU-132">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-134" value="&lt;font color=&quot;#000000&quot;&gt;if (def.getPropagationBehavior() &lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#000000&quot;&gt;==&lt;/font&gt;&lt;b&gt; TransactionDefinition.PROPAGATION_MANDATORY&lt;/b&gt;&lt;font color=&quot;#000000&quot;&gt;)&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-133">
          <mxGeometry x="-0.1177" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-136" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-128" target="4VrhSYovmqzg8rR9ZFnU-135">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-128" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1677.505" y="1960" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-132" value="&lt;div&gt;throw new IllegalTransactionStateException(&lt;/div&gt;&lt;div&gt;&lt;span&gt;					&lt;/span&gt;&quot;No existing transaction found for transaction marked with propagation &#39;mandatory&#39;&quot;);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="2180.01" y="1970" width="269.99" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-139" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-135" target="4VrhSYovmqzg8rR9ZFnU-138">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-140" value="&lt;div style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;if (def.getPropagationBehavior() ==&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;TransactionDefinition.PROPAGATION_REQUIRED&lt;/font&gt;&lt;/b&gt;&amp;nbsp;||&lt;/div&gt;&lt;div style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;def.getPropagationBehavior() ==&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;TransactionDefinition.PROPAGATION_REQUIRES_NEW&lt;/font&gt;&lt;/b&gt;&amp;nbsp;||&lt;/div&gt;&lt;div style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;def.getPropagationBehavior() ==&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;TransactionDefinition.PROPAGATION_NESTED&lt;/font&gt;&lt;/b&gt;)&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-139">
          <mxGeometry x="-0.1595" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-299" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-135" target="4VrhSYovmqzg8rR9ZFnU-298">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-135" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1677.505" y="2110" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-154" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-138" target="4VrhSYovmqzg8rR9ZFnU-155">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2120" y="2350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-226" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-138" target="4VrhSYovmqzg8rR9ZFnU-225">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-138" value="SuspendedResourcesHolder suspendedResources = &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;suspend(null);&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1526.25" y="2320" width="382.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-141" value="在存在事务的情况下，按不同隔离级别进行处理&lt;br&gt;进入这里通常都是：一个含事务的方法调用另一个含事务的方法" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2140" y="1738.5" width="370" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-142" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-141" parent="1" source="4VrhSYovmqzg8rR9ZFnU-123">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1975" y="1774" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-143" value="mandatory 表示强制需要事务，但是这里却没有事务，直接抛异常" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1840" y="1910" width="380" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-144" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-143" parent="1" source="4VrhSYovmqzg8rR9ZFnU-132">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2050" y="1940" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-145" value="是否存在以有连接" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1518" y="1780" width="130" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-146" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-145" parent="1" source="4VrhSYovmqzg8rR9ZFnU-121">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1503" y="1820" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-147" value="判断隔离级别" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1554" y="1940" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-148" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-147" source="4VrhSYovmqzg8rR9ZFnU-128">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1667.7550000000006" y="1980" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-149" value="判断隔离级别" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1560" y="2090" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-150" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-149" source="4VrhSYovmqzg8rR9ZFnU-135">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1661.5050000000006" y="2120" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-151" value="事务挂起" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1874.38" y="2280" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-152" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-151" parent="1" source="4VrhSYovmqzg8rR9ZFnU-138">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1960" y="2310" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-157" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-155" target="4VrhSYovmqzg8rR9ZFnU-156">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-158" value="if (TransactionSynchronizationManager.isSynchronizationActive())" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-157">
          <mxGeometry x="-0.1267" y="-1" relative="1" as="geometry">
            <mxPoint x="22" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-204" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-155" target="4VrhSYovmqzg8rR9ZFnU-203">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-155" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="2149.995" y="2310" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-160" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-156" target="4VrhSYovmqzg8rR9ZFnU-159">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-169" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-156" target="4VrhSYovmqzg8rR9ZFnU-168">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-156" value="List&amp;lt;TransactionSynchronization&amp;gt; suspendedSynchronizations = doSuspendSynchronization();" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="2660" y="2320" width="380.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-159" value="&lt;div&gt;private List&amp;lt;TransactionSynchronization&amp;gt; doSuspendSynchronization() {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;List&amp;lt;TransactionSynchronization&amp;gt; suspendedSynchronizations =&amp;nbsp;&lt;/span&gt;&lt;span&gt;&lt;b&gt;TransactionSynchronizationManager.getSynchronizations();&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;for (TransactionSynchronization synchronization : suspendedSynchronizations) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;synchronization.suspend();&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 执行完之后清空&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.clearSynchronization();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return suspendedSynchronizations;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;align=left;" vertex="1" parent="1">
          <mxGeometry x="3140" y="2338" width="738" height="150" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-163" value="判断是否注册了事务同步器" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2240" y="2280" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-164" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-163" parent="1" source="4VrhSYovmqzg8rR9ZFnU-155">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2245" y="2310" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-165" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;try&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="344.01" y="2890" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-166" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;catch&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="343.99" y="3100" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-167" value="finally" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="343.99" y="3330" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-171" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-168" target="4VrhSYovmqzg8rR9ZFnU-170">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-168" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;try&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="2804" y="2435" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-173" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-170" target="4VrhSYovmqzg8rR9ZFnU-172">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-174" value="if (transaction != null)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-173">
          <mxGeometry x="-0.3284" y="-4" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-170" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2810" y="2530" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-176" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-172" target="4VrhSYovmqzg8rR9ZFnU-175">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-220" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-172" target="4VrhSYovmqzg8rR9ZFnU-219">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-172" value="&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;suspendedResources&lt;/font&gt;&lt;/b&gt; = doSuspend(transaction);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="2710.01" y="2670" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-180" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-175" target="4VrhSYovmqzg8rR9ZFnU-179">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-198" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-175" target="4VrhSYovmqzg8rR9ZFnU-192">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3250" y="2840" />
              <mxPoint x="3250" y="3390" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-175" value="&lt;div&gt;String &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;name&lt;/font&gt;&lt;/b&gt; = TransactionSynchronizationManager.getCurrentTransactionName();&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionName(null);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="2617.5099999999998" y="2810" width="464.98" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-177" value="获取事务的名字&lt;br&gt;并将当前事务名字设置为 null" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2510" y="2750" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-178" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-177" parent="1" source="4VrhSYovmqzg8rR9ZFnU-175">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2703.755" y="2800" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-184" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-179" target="4VrhSYovmqzg8rR9ZFnU-183">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-199" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-179" target="4VrhSYovmqzg8rR9ZFnU-192">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3180" y="3370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3220" y="2980" />
              <mxPoint x="3220" y="3390" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-179" value="&lt;div&gt;boolean &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;readOnly&lt;/font&gt;&lt;/b&gt; = TransactionSynchronizationManager.isCurrentTransactionReadOnly();&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionReadOnly(false);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="2590.01" y="2950" width="520" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-181" value="获取是否可读&lt;br&gt;并将当前是否可读设置为 false" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2500" y="2892.5" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-182" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-181" source="4VrhSYovmqzg8rR9ZFnU-179">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2693.755" y="2940" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-188" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-183" target="4VrhSYovmqzg8rR9ZFnU-187">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-200" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-183" target="4VrhSYovmqzg8rR9ZFnU-192">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3150" y="3190" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3190" y="3120" />
              <mxPoint x="3190" y="3390" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-183" value="&lt;div&gt;Integer &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;isolationLevel&lt;/font&gt;&lt;/b&gt; = TransactionSynchronizationManager.getCurrentTransactionIsolationLevel();&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionIsolationLevel(null);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="2570.01" y="3090" width="559.99" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-185" value="获取事务的隔离级别&lt;br&gt;并将当前事务隔离级别设置为 null" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2471" y="3040" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-186" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-185" source="4VrhSYovmqzg8rR9ZFnU-183">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2689.995" y="3090" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-193" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-187" target="4VrhSYovmqzg8rR9ZFnU-192">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-201" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-187" target="4VrhSYovmqzg8rR9ZFnU-192">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-187" value="&lt;div&gt;boolean &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;wasActive&lt;/font&gt;&lt;/b&gt; = TransactionSynchronizationManager.isActualTransactionActive();&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;TransactionSynchronizationManager.setActualTransactionActive(false);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="2595.01" y="3230" width="509.99" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-189" value="获取事务是否活跃&lt;br&gt;并将当前事务是否活跃设置为 false" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2466" y="3180" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-190" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-189" source="4VrhSYovmqzg8rR9ZFnU-187">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2710.0075000000006" y="3230" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-195" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-192" target="4VrhSYovmqzg8rR9ZFnU-194">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-218" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-192" target="4VrhSYovmqzg8rR9ZFnU-138">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2280" y="2770" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2350" y="3390" />
              <mxPoint x="2350" y="2365" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-192" value="&lt;div&gt;return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;new SuspendedResourcesHolder(&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;span&gt;						&lt;/span&gt;suspendedResources, suspendedSynchronizations, name, readOnly, isolationLevel, wasActive);&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="2547.5099999999998" y="3360" width="604.98" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-197" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-194" target="4VrhSYovmqzg8rR9ZFnU-196">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-194" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;catch&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="2804" y="3470" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-224" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-196" target="4VrhSYovmqzg8rR9ZFnU-223">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-196" value="&lt;div&gt;doResumeSynchronization(suspendedSynchronizations);&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;throw ex;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2665" y="3580" width="370" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-206" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-203" target="4VrhSYovmqzg8rR9ZFnU-212">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2440" y="2510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-211" value="if (transaction != null)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-206">
          <mxGeometry x="-0.0899" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-209" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-203" target="4VrhSYovmqzg8rR9ZFnU-208">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-210" value="事务为 null 的情况" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-209">
          <mxGeometry x="-0.1309" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-203" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="2149.995" y="2470" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-216" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-208" target="4VrhSYovmqzg8rR9ZFnU-138">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1960" y="2440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-208" value="return null;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="2129.995" y="2640" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-213" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-212" target="4VrhSYovmqzg8rR9ZFnU-172">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-215" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-212" target="4VrhSYovmqzg8rR9ZFnU-214">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-212" value="&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;suspendedResources&lt;/font&gt;&lt;/b&gt; = doSuspend(transaction);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="2400" y="2480" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-217" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-214" target="4VrhSYovmqzg8rR9ZFnU-138">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1940" y="2390" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2080" y="2630" />
              <mxPoint x="2080" y="2365" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-214" value="return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;new SuspendedResourcesHolder(suspendedResources);&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="2385" y="2600" width="310" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-219" value="&lt;div&gt;@Override&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;protected Object doSuspend(Object transaction) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;DataSourceTransactionObject txObject = (DataSourceTransactionObject) transaction;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 将连接设置为空&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;txObject.setConnectionHolder(null);&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 移除并返回数据库连接&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return TransactionSynchronizationManager.unbindResource(obtainDataSource());&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;align=left;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="3212" y="2622.5" width="510" height="155" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-221" value="将当前的连接对象设置为 null&lt;br&gt;并返回原有的连接对象 connection" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3097" y="2560" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-222" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-221" parent="1" source="4VrhSYovmqzg8rR9ZFnU-219">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3122" y="2590" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-223" value="&lt;div&gt;private void doResumeSynchronization(List&amp;lt;TransactionSynchronization&amp;gt; suspendedSynchronizations)&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.initSynchronization();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;for (TransactionSynchronization synchronization : suspendedSynchronizations) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;synchronization.resume();&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;TransactionSynchronizationManager.registerSynchronization(synchronization);&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;align=left;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="3152.49" y="3550" width="610" height="120" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-228" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-225" target="4VrhSYovmqzg8rR9ZFnU-227">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-225" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;try&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="1671.5" y="2435" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-230" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-227" target="4VrhSYovmqzg8rR9ZFnU-229">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-235" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-227" target="4VrhSYovmqzg8rR9ZFnU-234">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-253" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-227" target="4VrhSYovmqzg8rR9ZFnU-112">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-227" value="return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;startTransaction&lt;/font&gt;&lt;/b&gt;(def, transaction, debugEnabled, suspendedResources);" style="whiteSpace=wrap;html=1;fillColor=#6a00ff;strokeColor=#3700CC;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1546.25" y="2560" width="342.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-232" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-229" target="4VrhSYovmqzg8rR9ZFnU-231">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-229" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;catch&lt;br&gt;&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="1671.5" y="2680" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-231" value="&lt;div&gt;resume(null, suspendedResources);&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;throw ex;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#6d8764;strokeColor=#3A5431;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1601.25" y="2805" width="232.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-237" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-234" target="4VrhSYovmqzg8rR9ZFnU-236">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-234" value="&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;DefaultTransactionStatus status&lt;/font&gt;&lt;/b&gt; = newTransactionStatus(&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;definition, transaction, true, newSynchronization, debugEnabled, suspendedResources);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1880" y="2920" width="481.25" height="70" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-239" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-236" target="4VrhSYovmqzg8rR9ZFnU-238">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-257" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-236" target="4VrhSYovmqzg8rR9ZFnU-354">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2360" y="3370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-236" value="doBegin(transaction, definition);" style="whiteSpace=wrap;html=1;fillColor=#d80073;strokeColor=#A50040;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="2020.94" y="3150" width="199.37" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-241" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-238" target="4VrhSYovmqzg8rR9ZFnU-240">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-243" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-238" target="4VrhSYovmqzg8rR9ZFnU-242">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-238" value="prepareSynchronization(status, definition);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1995.93" y="3290" width="249.38" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-244" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;entryX=0.75;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-240" target="4VrhSYovmqzg8rR9ZFnU-227">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1750" y="3190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-240" value="return status;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="2060.62" y="3430" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-242" value="&lt;div&gt;protected void prepareSynchronization(DefaultTransactionStatus status, TransactionDefinition definition) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;if (status.isNewSynchronization()) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 事务是否活&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setActualTransactionActive(status.hasTransaction());&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 设置隔离级别&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionIsolationLevel(&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;definition.getIsolationLevel() != TransactionDefinition.ISOLATION_DEFAULT ?&amp;nbsp;&lt;/span&gt;&lt;span&gt;definition.getIsolationLevel() : null);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 设置是否可读&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionReadOnly(definition.isReadOnly());&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 设置事务的名字&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionName(definition.getName());&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;// 初始化 TransactionSynchronization&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.initSynchronization();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;}&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;align=left;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1277.5" y="3410" width="710" height="250" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-248" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-245" target="4VrhSYovmqzg8rR9ZFnU-247">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-245" value="TransactionInfo txInfo = new TransactionInfo(tm, txAttr, joinpointIdentification);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="766.0799999999999" y="2770" width="435.95" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-250" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-247" target="4VrhSYovmqzg8rR9ZFnU-249">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-247" value="txInfo.newTransactionStatus(status);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="866.9899999999999" y="2877.5" width="235.95" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-249" value="&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;txInfo.bindToThread();&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="911.5400000000001" y="3010" width="145.04" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-251" value="开启事物后，transaction 中就会有数据库连接了&lt;br&gt;并且 transaction.newConnectionHolder.isTransactionActive 为 true&lt;br&gt;并返回 TransactionStatus 对象，该对象保存了很多信息，包括被挂起的资源" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1161.25" y="2480" width="440" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-252" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-251" parent="1" source="4VrhSYovmqzg8rR9ZFnU-227">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1370" y="2490" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-254" value="执行挂起操作&lt;br&gt;并返回数据库连接对象" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2950" y="2615" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-255" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-254" parent="1" source="4VrhSYovmqzg8rR9ZFnU-172">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2985" y="2650" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-259" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-256" target="4VrhSYovmqzg8rR9ZFnU-258">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-260" value="&lt;div&gt;&lt;span style=&quot;font-size: 11px&quot;&gt;if (!txObject.hasConnectionHolder() ||&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-size: 11px&quot;&gt;&lt;span&gt;					&lt;/span&gt;txObject.getConnectionHolder().isSynchronizedWithTransaction())&lt;/span&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-259">
          <mxGeometry x="-0.1905" y="2" relative="1" as="geometry">
            <mxPoint x="-1" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-256" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2320.005" y="3420" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-262" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-258" target="4VrhSYovmqzg8rR9ZFnU-261">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-258" value="Connection newCon = obtainDataSource().getConnection();" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="2190.31" y="3610" width="339.99" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-264" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-261" target="4VrhSYovmqzg8rR9ZFnU-263">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-261" value="txObject.setConnectionHolder(new ConnectionHolder(newCon), &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;true&lt;/font&gt;&lt;/b&gt;);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2157.66" y="3730" width="404.69" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-270" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-263" target="4VrhSYovmqzg8rR9ZFnU-269">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-263" value="txObject.getConnectionHolder().setSynchronizedWithTransaction(&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;true&lt;/font&gt;&lt;/b&gt;);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2160.46" y="3840" width="399.69" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-265" value="从数据库获取连接对象" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2090" y="3570" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-266" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-265" parent="1" source="4VrhSYovmqzg8rR9ZFnU-258">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2015" y="3610" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-267" value="标记为新的连接对象" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2090" y="3690" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-268" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-267" parent="1" source="4VrhSYovmqzg8rR9ZFnU-261">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2080" y="3720" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-274" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-269" target="4VrhSYovmqzg8rR9ZFnU-273">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-269" value="&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;con.setAutoCommit(false);&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="2270" y="3980" width="179.7" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-271" value="设置自动提交为 false" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2140" y="3940" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-272" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-271" parent="1" source="4VrhSYovmqzg8rR9ZFnU-269">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2170" y="3970" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-278" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-273" target="4VrhSYovmqzg8rR9ZFnU-277">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-280" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-273" target="4VrhSYovmqzg8rR9ZFnU-279">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-273" value="prepareTransactionalConnection(con, definition);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="2220.31" y="4092" width="280.15" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-275" value="如果 readOnly 为 true&lt;br&gt;则将数据库事务设置为只读" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2075" y="4040" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-276" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-275" source="4VrhSYovmqzg8rR9ZFnU-273">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2264.925" y="4090" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-277" value="&lt;div&gt;protected void prepareTransactionalConnection(Connection con, TransactionDefinition definition)&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;throws SQLException {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;if (isEnforceReadOnly() &amp;amp;&amp;amp; &lt;b&gt;definition.isReadOnly()&lt;/b&gt;) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;/span&gt;try (Statement stmt = con.createStatement()) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;stmt.executeUpdate(&quot;SET TRANSACTION READ ONLY&quot;);&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="2590" y="4051" width="540" height="142" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-284" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-279" target="4VrhSYovmqzg8rR9ZFnU-283">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-279" value="txObject.getConnectionHolder().setTransactionActive(&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;true&lt;/font&gt;&lt;/b&gt;);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="2190.04" y="4232" width="339.62" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-281" value="标记事物已经激活" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2115.31" y="4180" width="130" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-282" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-281" parent="1" source="4VrhSYovmqzg8rR9ZFnU-279">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2110" y="4210" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-286" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeColor=#000000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-283" target="4VrhSYovmqzg8rR9ZFnU-285">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-287" value="if (txObject.isNewConnectionHolder())" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-286">
          <mxGeometry x="-0.3704" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-283" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2319.85" y="4350" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-358" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-285" target="4VrhSYovmqzg8rR9ZFnU-357">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-285" value="TransactionSynchronizationManager.&lt;b&gt;bindResource&lt;/b&gt;(&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;obtainDataSource()&lt;/font&gt;&lt;/b&gt;, &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;txObject.getConnectionHolder()&lt;/font&gt;&lt;/b&gt;);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="2053.02" y="4490" width="614.73" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-288" value="ThreadLocal&amp;lt;Map&amp;lt;Object, Object&amp;gt;&amp;gt; resources&lt;br&gt;将数据源与连接对象保存在 ThreadLocal 中&lt;br&gt;key 为数据源，value 为连接对象" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1900.01" y="4410" width="280" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-289" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;strokeColor=#000000;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-288" parent="1" source="4VrhSYovmqzg8rR9ZFnU-285">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2070" y="4460" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-290" value="准备事务信息&lt;br&gt;包含：事务管理器、事务注解信息，事务状态" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1110" y="2570" width="270" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-291" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-290" parent="1" source="4VrhSYovmqzg8rR9ZFnU-114">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="755" y="2590" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-292" value="ThreadLocal&amp;lt;TransactionInfo&amp;gt; transactionInfoHolder" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="612.5" y="2960" width="310" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-293" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-292" parent="1" source="4VrhSYovmqzg8rR9ZFnU-249">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="646" y="2943" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-302" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-298" target="4VrhSYovmqzg8rR9ZFnU-301">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-298" value="boolean newSynchronization = (getTransactionSynchronization() == SYNCHRONIZATION_ALWAYS);" style="whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;rounded=0;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="1187.5" y="2940" width="358.75" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-301" value="return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;prepareTransactionStatus&lt;/font&gt;&lt;/b&gt;(def, null, true, newSynchronization, debugEnabled, null);" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="1110" y="3080" width="513.13" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-307" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-304" target="4VrhSYovmqzg8rR9ZFnU-306">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-308" value="if (definition.getPropagationBehavior() == &lt;br&gt;TransactionDefinition.PROPAGATION_NEVER)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-307">
          <mxGeometry x="-0.2255" y="-2" relative="1" as="geometry">
            <mxPoint x="22" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-310" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-304" target="4VrhSYovmqzg8rR9ZFnU-309">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-304" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2547.51" y="975" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-306" value="&lt;div&gt;throw new IllegalTransactionStateException(&lt;/div&gt;&lt;div&gt;&lt;span&gt;					&lt;/span&gt;&quot;Existing transaction found for transaction marked with propagation &#39;never&#39;&quot;);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2967.5099999999993" y="985" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-312" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-309" target="4VrhSYovmqzg8rR9ZFnU-311">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-313" value="if (definition.getPropagationBehavior() == &lt;br&gt;TransactionDefinition.PROPAGATION_NOT_SUPPORTED)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-312">
          <mxGeometry x="-0.1753" y="-1" relative="1" as="geometry">
            <mxPoint x="28" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-326" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-309" target="4VrhSYovmqzg8rR9ZFnU-325">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-309" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2547.51" y="1125" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-319" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-311" target="4VrhSYovmqzg8rR9ZFnU-318">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-349" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;dashed=1;fontColor=#FF0000;strokeWidth=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-311" target="4VrhSYovmqzg8rR9ZFnU-138">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1900" y="2200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-311" value="Object suspendedResources = &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;suspend(transaction);&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="3020" y="1135" width="317.51" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-314" value="PROPAGATION_NEVER&lt;br&gt;表示不支持当前有一个事务。然后继续调用含有事务的方法，就会抛出异常" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2635.01" y="920" width="430" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-315" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-314" parent="1" source="4VrhSYovmqzg8rR9ZFnU-304">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2787.51" y="935" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-316" value="PROPAGATION_NOT_SUPPORTED&lt;br&gt;只是挂起原来的事务，不开启新的事务" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2660" y="1077.5" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-317" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-316" parent="1" source="4VrhSYovmqzg8rR9ZFnU-309">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2772.51" y="1108" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-321" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-318" target="4VrhSYovmqzg8rR9ZFnU-320">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-318" value="boolean newSynchronization = (getTransactionSynchronization() == SYNCHRONIZATION_ALWAYS);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2989.37" y="1252.5" width="378.76" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-332" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;fontColor=#FF0000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-320" target="4VrhSYovmqzg8rR9ZFnU-123">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2640" y="1402" />
              <mxPoint x="2640" y="1855" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-320" value="&lt;div&gt;return prepareTransactionStatus(&lt;/div&gt;&lt;div&gt;&lt;span&gt;					&lt;/span&gt;definition, null, false, newSynchronization, debugEnabled, suspendedResources);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontStyle=0;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="2999.37" y="1372" width="358.76" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-328" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-325" target="4VrhSYovmqzg8rR9ZFnU-327">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-329" value="if (definition.getPropagationBehavior() == &lt;br&gt;TransactionDefinition.PROPAGATION_REQUIRES_NEW)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-328">
          <mxGeometry x="-0.0727" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-389" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-325" target="4VrhSYovmqzg8rR9ZFnU-388">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-325" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2548.51" y="1505" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-340" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-327" target="4VrhSYovmqzg8rR9ZFnU-341">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3266.5555555555547" y="1655" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-348" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-327" target="4VrhSYovmqzg8rR9ZFnU-138">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2140" y="2260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-327" value="SuspendedResourcesHolder suspendedResources = &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;suspend(transaction);&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="3044.2700000000004" y="1515" width="444.49" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-333" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=2;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-330" target="4VrhSYovmqzg8rR9ZFnU-123">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2420" y="1810" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-345" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-330" target="4VrhSYovmqzg8rR9ZFnU-342">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-351" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;dashed=1;fontColor=#FF0000;strokeWidth=1;entryX=1;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-330" target="4VrhSYovmqzg8rR9ZFnU-227">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2500" y="2220" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-330" value="return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;startTransaction&lt;/font&gt;&lt;/b&gt;(definition, transaction, debugEnabled, suspendedResources);" style="whiteSpace=wrap;html=1;fillColor=#6a00ff;strokeColor=#3700CC;rounded=0;spacing=6;fontStyle=0;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="3086.0200000000004" y="1730" width="361" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-334" value="挂起当前事务" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3407.49" y="1460" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-335" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-334" parent="1" source="4VrhSYovmqzg8rR9ZFnU-327">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3358.13" y="1480" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-336" value="开启一个新的事物" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3377.4900000000002" y="1680" width="130" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-337" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" target="4VrhSYovmqzg8rR9ZFnU-336" source="4VrhSYovmqzg8rR9ZFnU-330">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3384.287500000001" y="1766.25" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-344" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-341" target="4VrhSYovmqzg8rR9ZFnU-330">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-341" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;try&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="3220.5099999999998" y="1620" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-347" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-342" target="4VrhSYovmqzg8rR9ZFnU-346">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-342" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;catch&lt;br&gt;&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="3220.51" y="1830" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-364" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=2;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-346" target="4VrhSYovmqzg8rR9ZFnU-363">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-346" value="&lt;div&gt;resumeAfterBeginException(transaction, suspendedResources, beginEx);&lt;/div&gt;&lt;div&gt;&lt;span&gt;				&lt;/span&gt;throw beginEx;&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="3054.7800000000007" y="1930" width="423.49" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-352" value="判断是否有连接对象" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2400" y="3400" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-353" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-352" parent="1" source="4VrhSYovmqzg8rR9ZFnU-256">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2440" y="3450" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-356" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-354" target="4VrhSYovmqzg8rR9ZFnU-256">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-354" value="try" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="2314.39" y="3330" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-360" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-357" target="4VrhSYovmqzg8rR9ZFnU-359">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-357" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;catch&lt;/span&gt;" style="shape=step;perimeter=stepPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fontColor=#000000;fillColor=#fa6800;strokeColor=#C73500;" vertex="1" parent="1">
          <mxGeometry x="2313.85" y="4590" width="92" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-359" value="&lt;div&gt;if (txObject.isNewConnectionHolder()) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;DataSourceUtils.releaseConnection(con, obtainDataSource());&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;span&gt;				&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;txObject.setConnectionHolder(null, false);&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;throw new CannotCreateTransactionException(&quot;Could not open JDBC Connection for transaction&quot;, ex);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;align=left;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="2077.46" y="4720" width="564.77" height="110" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-361" value="释放数据库连接" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2060.63" y="4660" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-362" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-361" parent="1" source="4VrhSYovmqzg8rR9ZFnU-359">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1948" y="4640" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-366" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-363" target="4VrhSYovmqzg8rR9ZFnU-365">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-363" value="&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;resume&lt;/font&gt;&lt;/b&gt;(transaction, suspendedResources);" style="whiteSpace=wrap;html=1;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="3650" y="1180" width="279.98" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-368" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-365" target="4VrhSYovmqzg8rR9ZFnU-367">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-370" value="if (resourcesHolder != null)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-368">
          <mxGeometry x="-0.2222" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-365" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3749.99" y="1280" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-372" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-367" target="4VrhSYovmqzg8rR9ZFnU-371">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-367" value="Object suspendedResources = resourcesHolder.suspendedResources;" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="3669.99" y="1420" width="240.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-374" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-371" target="4VrhSYovmqzg8rR9ZFnU-373">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-371" value="&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;doResume&lt;/font&gt;&lt;/b&gt;(transaction, suspendedResources);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="3649.97" y="1525" width="280.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-376" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=2;dashed=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-373" target="4VrhSYovmqzg8rR9ZFnU-375">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-373" value="&lt;div&gt;List&amp;lt;TransactionSynchronization&amp;gt; suspendedSynchronizations = resourcesHolder.suspendedSynchronizations;&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;if (suspendedSynchronizations != null) {&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setActualTransactionActive(resourcesHolder.&lt;b&gt;wasActive&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionIsolationLevel(resourcesHolder.&lt;b&gt;isolationLevel&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionReadOnly(resourcesHolder.&lt;b&gt;readOnly&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.setCurrentTransactionName(resourcesHolder.&lt;b&gt;name&lt;/b&gt;);&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;doResumeSynchronization(suspendedSynchronizations);&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;spacing=6;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="3620" y="1665" width="630.02" height="145" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-375" value="&lt;div&gt;private void doResumeSynchronization(List&amp;lt;TransactionSynchronization&amp;gt; suspendedSynchronizations) {&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;TransactionSynchronizationManager.initSynchronization();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;for (TransactionSynchronization synchronization : suspendedSynchronizations) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;synchronization.resume();&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;			&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;/span&gt;&lt;b&gt;TransactionSynchronizationManager.registerSynchronization(synchronization);&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;		&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;}&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="whiteSpace=wrap;html=1;align=left;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="3640.0099999999998" y="1880" width="590" height="127.5" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-377" value="调用同步器的 resume 方法&lt;br&gt;并将同步器在重新注册到 ThreadLocal 中" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3512.49" y="1825" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-378" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-377" parent="1" source="4VrhSYovmqzg8rR9ZFnU-375">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3640" y="1860" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-381" value="获取到原有挂起的对象" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3890" y="1380" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-382" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.75;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-381" parent="1" source="4VrhSYovmqzg8rR9ZFnU-367">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3910" y="1400" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-383" value="判断是否有挂起的事物" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3830" y="1260" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-384" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-383" parent="1" source="4VrhSYovmqzg8rR9ZFnU-365">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3820" y="1301" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-391" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-388" target="4VrhSYovmqzg8rR9ZFnU-393">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3070" y="2100" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-392" value="if (definition.getPropagationBehavior() == &lt;br&gt;TransactionDefinition.PROPAGATION_NESTED)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-391">
          <mxGeometry x="-0.1704" y="2" relative="1" as="geometry">
            <mxPoint x="21" y="2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-408" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-388" target="4VrhSYovmqzg8rR9ZFnU-407">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-410" value="Propagation.REQUIRED" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-408">
          <mxGeometry x="-0.6049" y="8" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-388" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2548.51" y="2060" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-395" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-393" target="4VrhSYovmqzg8rR9ZFnU-394">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-396" value="if (useSavepointForNestedTransaction())" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-395">
          <mxGeometry x="-0.1436" y="-3" relative="1" as="geometry">
            <mxPoint x="14" y="-3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-403" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.25;entryY=1;entryDx=0;entryDy=0;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-393" target="4VrhSYovmqzg8rR9ZFnU-330">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="3015" y="1890" />
              <mxPoint x="3176" y="1890" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-404" value="&lt;span style=&quot;font-size: 11px&quot;&gt;JtaTransactionManager&lt;/span&gt;&lt;br&gt;不支持保存点" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontColor=#FF0000;" vertex="1" connectable="0" parent="4VrhSYovmqzg8rR9ZFnU-403">
          <mxGeometry x="-0.7798" relative="1" as="geometry">
            <mxPoint y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-393" value="判断" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2974.78" y="2060" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-406" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-394" target="4VrhSYovmqzg8rR9ZFnU-405">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-422" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;dashed=1;fontColor=#FF0000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-394" target="4VrhSYovmqzg8rR9ZFnU-420">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-394" value="&lt;div&gt;DefaultTransactionStatus status =&lt;/div&gt;&lt;div&gt;&lt;span&gt;						&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;prepareTransactionStatus&lt;/font&gt;&lt;/b&gt;(definition, transaction, false, false, debugEnabled, null);&lt;/div&gt;" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="3337.51" y="2070" width="472.49" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-397" value="如果是嵌入式的事物" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2650" y="2030" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-398" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-397" parent="1" source="4VrhSYovmqzg8rR9ZFnU-388">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2642.23" y="2070" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-399" value="新开一个事物&amp;nbsp;" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2628.51" y="1470" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-400" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-399" parent="1" source="4VrhSYovmqzg8rR9ZFnU-325">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2680" y="1470" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-401" value="是否支持保存点" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="3070" y="2030" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-402" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=1;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-401" parent="1" source="4VrhSYovmqzg8rR9ZFnU-393">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="3092" y="2060" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-425" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-405" target="4VrhSYovmqzg8rR9ZFnU-424">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-405" value="status.createAndHoldSavepoint();" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="3890" y="2070" width="216.24" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-414" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF0000;strokeWidth=1;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-407" target="4VrhSYovmqzg8rR9ZFnU-413">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-407" value="boolean newSynchronization = (getTransactionSynchronization() != SYNCHRONIZATION_NEVER);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="2710.01" y="2200" width="401.49" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-411" value="默认的传播机制 REQUIRED" style="whiteSpace=wrap;html=1;shape=partialRectangle;top=0;left=0;bottom=1;right=0;points=[[0,1],[1,1]];fillColor=#fff2cc;align=center;verticalAlign=bottom;routingCenterY=0.5;snapToPoint=1;recursiveResize=0;autosize=1;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1};rounded=0;sketch=0;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="2840" y="2160" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-412" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;rounded=0;fontColor=#000000;sketch=0;strokeWidth=1;exitX=0.25;exitY=0;exitDx=0;exitDy=0;" edge="1" target="4VrhSYovmqzg8rR9ZFnU-411" parent="1" source="4VrhSYovmqzg8rR9ZFnU-407">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2770.3825000000006" y="2200" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-421" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;fontColor=#FF0000;strokeWidth=2;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-413" target="4VrhSYovmqzg8rR9ZFnU-420">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-423" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=2;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-413" target="4VrhSYovmqzg8rR9ZFnU-123">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2540" y="2120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3221" y="2290" />
              <mxPoint x="2520" y="2290" />
              <mxPoint x="2520" y="1855" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-413" value="return &lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;prepareTransactionStatus&lt;/font&gt;&lt;/b&gt;(definition, transaction, false, newSynchronization, debugEnabled, null);" style="whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;rounded=0;spacing=6;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="3220.51" y="2200" width="359.49" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-420" value="&lt;div&gt;protected final DefaultTransactionStatus prepareTransactionStatus(&lt;span&gt;TransactionDefinition definition, @Nullable Object transaction,&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;boolean newTransaction,&amp;nbsp;&lt;/span&gt;&lt;span&gt;boolean newSynchronization, boolean debug, @Nullable Object suspendedResources) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;DefaultTransactionStatus status = &lt;b&gt;newTransactionStatus&lt;/b&gt;(definition, transaction, newTransaction, newSynchronization, debug, suspendedResources);&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;prepareSynchronization&lt;/font&gt;&lt;/b&gt;(status, definition);&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;return status;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;	&lt;/span&gt;}&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;sketch=0;fontColor=#333333;fillColor=#f5f5f5;strokeColor=#666666;align=left;spacing=6;" vertex="1" parent="1">
          <mxGeometry x="3660" y="2155" width="850" height="150" as="geometry" />
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-426" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=1;sketch=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;fontColor=#FF0000;strokeWidth=2;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="4VrhSYovmqzg8rR9ZFnU-424" target="4VrhSYovmqzg8rR9ZFnU-123">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2840" y="1920" as="targetPoint" />
            <Array as="points">
              <mxPoint x="4234" y="2040" />
              <mxPoint x="2980" y="2040" />
              <mxPoint x="2980" y="1855" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4VrhSYovmqzg8rR9ZFnU-424" value="return status;" style="whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=0;spacing=6;fontStyle=0;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="4234.36" y="2070" width="120" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
